
<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StarCrown - Holiday Planner 2026</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
          --color-bg: #F9FAFB; --color-surface: #FFFFFF; --color-surface-hover: rgba(59, 130, 246, 0.1); --color-primary: #3B82F6; --color-button-text: #FFFFFF; --color-text-primary: #1F2937; --color-text-secondary: #6B7280; --color-border: #E5E7EB; --color-success: #16A34A; --color-danger: #EF4444; --color-row-even-bg: #F3F4F6;
          --tag-yes-bg: #DCFCE7; --tag-yes-text: #15803D; --tag-yes-border: #86EFAC;
          --tag-no-bg: #F3F4F6; --tag-no-text: #6B7280; --tag-no-border: #E5E7EB;
        }
        [data-theme="dark"] {
          --color-bg: #111827; --color-surface: #151D2F; --color-surface-hover: #1E2840; --color-primary: #00BCD4; --color-button-text: #111827; --color-text-primary: #E9FAFA; --color-text-secondary: #B0BEC5; --color-border: #374151; --color-success: #4ADE80; --color-danger: #f77272; --color-row-even-bg: var(--color-bg);
          --tag-yes-bg: #163422; --tag-yes-text: #4ADE80; --tag-yes-border: #235538;
          --tag-no-bg: #374151; --tag-no-text: #9CA3AF; --tag-no-border: #4B5563;
        }
        :root {
          --font-main: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
          --radius-main: 12px; --radius-small: 8px; --space-unit: 8px;
        }
        body { font-family: var(--font-main); line-height: 1.5; background-color: var(--color-bg); color: var(--color-text-primary); margin: 0; padding: calc(var(--space-unit) * 2); transition: background-color 0.3s ease, color 0.3s ease; }
        .container { max-width: 1400px; margin: auto; }
        main .container { background: var(--color-surface); padding: calc(var(--space-unit) * 3); border-radius: var(--radius-main); border: 1px solid var(--color-border); transition: background-color 0.3s ease, border-color 0.3s ease; }
        header#controls-section { position: sticky; top: 0; z-index: 20; background: var(--color-bg); padding: 12px 0; margin-bottom: 12px; }
        footer { text-align: center; margin-top: 3rem; font-size: 0.9em; color: var(--color-text-secondary); } footer strong { color: var(--color-primary); }
        .controls-panel { display: flex; gap: 1em; align-items: center; }
        .control-btn { background-color: var(--color-surface); border: 1px solid var(--color-border); padding: 0; border-radius: var(--radius-small); color: var(--color-text-secondary); cursor: pointer; display: flex; align-items: center; justify-content: center; height: 48px; width: 48px; flex-shrink: 0; transition: all 0.2s ease; }
        .control-btn:hover { border-color: var(--color-primary); color: var(--color-primary); }
        #theme-switcher .icon-sun { display: none; } #theme-switcher .icon-moon { display: block; }
        [data-theme="light"] #theme-switcher .icon-sun { display: block; } [data-theme="light"] #theme-switcher .icon-moon { display: none; }
        #scrollToTopBtn { position: fixed; bottom: 20px; right: 20px; z-index: 1000; opacity: 0; visibility: hidden; transform: translateY(20px); transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease; }
        #scrollToTopBtn.is-visible { opacity: 1; visibility: visible; transform: translateY(0); }
        .table-wrapper { overflow-x: auto; border: 1px solid var(--color-border); border-radius: var(--radius-small); }
        .data-table { border-collapse: collapse; width: 100%; min-width: 900px; }
        .data-table th, .data-table td { padding: 12px 14px; text-align: center; vertical-align: middle; }
        .data-table thead, .data-table tfoot { background-color: var(--color-bg); }
        .data-table th { font-weight: 600; white-space: nowrap; border-bottom: 1px solid var(--color-border); }
        .data-table td { border-bottom: 1px solid var(--color-border); }
        .data-table thead { position: sticky; top: 0; z-index: 10; }
        .data-table td:not(:last-child), .data-table th:not(:last-child) { border-right: 1px solid var(--color-border); }
        .data-table tbody tr:last-child td { border-bottom: none; }
        .data-table tbody tr:nth-child(even) { background-color: var(--color-row-even-bg); }
        .data-table tbody tr:hover { background-color: var(--color-surface-hover); }
        .data-table td[data-column-id="holiday"] { text-align: left; }
        .holiday-name { font-weight: 700; }
        .data-table tfoot th, .data-table tfoot td { padding-top: 16px; padding-bottom: 16px; font-weight: 700; border-top: 2px solid var(--color-border); }
        .data-table tfoot td { font-size: 1.4em; }
        .status-tag { display: inline-flex; align-items: center; justify-content: center; width: 24px; height: 24px; padding: 2px 8px; border-radius: 12px; font-size: 0.9em; font-weight: 700; line-height: 1.4; border: 1px solid transparent; }
        .status-tag--yes { background-color: var(--tag-yes-bg); color: var(--tag-yes-text); border-color: var(--tag-yes-border); }
        .status-tag--no { background-color: var(--tag-no-bg); border-color: var(--tag-no-border); }
        @media (max-width: 820px) {
          .table-wrapper { border: none; overflow-x: hidden; }
          .data-table, .data-table thead, .data-table tbody, .data-table tfoot, .data-table tr { display: block; }
          .data-table thead tr { display: none; }
          .data-table tbody tr, .data-table tfoot tr { display: flex; flex-wrap: wrap; border: 1px solid var(--color-border); border-radius: var(--radius-main); margin-bottom: 1rem; background-color: var(--color-surface); padding: 1rem; gap: 0.5rem 1rem; }
          .data-table tbody tr:nth-child(even) { background-color: var(--color-surface); }
          .data-table td, .data-table tfoot th { border: none; padding: 0; text-align: left; display: flex; align-items: baseline; justify-content: flex-end; width: 100%; border-bottom: 1px dashed var(--color-border); padding: 8px 0; }
          .data-table tbody tr td:last-child { border-bottom: none; }
          .data-table td::before, .data-table tfoot th::before { content: attr(data-label); font-weight: 600; color: var(--color-text-secondary); margin-right: auto; }
          .data-table td[data-column-id="holiday"] { order: -2; width: 100%; justify-content: flex-start; border-bottom: 1px solid var(--color-border); padding-bottom: 1rem; margin-bottom: 0.5rem; }
          .data-table td[data-column-id="holiday"]::before { display: none; }
          .data-table td[data-column-id="date"], .data-table td[data-column-id="day"], .data-table td[data-column-id="cw"], .data-table td[data-column-id="count"] { order: -1; width: calc(50% - 0.5rem); }
          .data-table td[data-column-id="cw"], .data-table td[data-column-id="count"] { justify-content: flex-end; text-align: right; }
          .data-table tfoot tr { background-color: transparent; border: none; padding: 0; }
          .data-table tfoot th, .data-table tfoot td { width: 100%; }
        }
    </style>
</head>
<body>
    <header id="controls-section">
        <div class="container"><div class="controls-panel">
            <button id="theme-switcher" class="control-btn" title="Switch color theme"><svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg><svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></button>
        </div></div>
    </header>
    <main>
        <div class="container"><div class="table-wrapper">
            <table class="data-table">
                <thead id="tableHeader"></thead>
                <tbody id="tableBody"></tbody>
                <tfoot id="tableFooter"></tfoot>
            </table>
        </div></div>
    </main>
    <footer><p>© <span id="copyright-year">2025</span> <strong>McBile AI-Engine</strong></p></footer>
    <button id="scrollToTopBtn" class="control-btn" title="Scroll to top"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg></button>
    <script>
    (() => {
        const holidayData = [
            { date: '01 Jan', day: 'Thu', cw: 'CW01', holidayName: 'New Year’s Day', countries: { PL: true, DE: true, CY: true, UA: true, BY: true, RS: true, GE: true, RU: true, AZ: true, KZ: true, AM: true } },
            { date: '02 Jan', day: 'Fri', cw: 'CW01', holidayName: 'New Year’s Holiday', countries: { PL: false, DE: false, CY: false, UA: false, BY: true, RS: false, GE: true, RU: true, AZ: true, KZ: true, AM: true } },
            { date: '07 Jan', day: 'Wed', cw: 'CW02', holidayName: 'Christmas Day (Orthodox)', countries: { PL: false, DE: false, CY: false, UA: false, BY: true, RS: true, GE: true, RU: true, AZ: false, KZ: true, AM: false } }, 
            { date: '08 Mar', day: 'Sun', cw: 'CW10', holidayName: 'International Women\'s Day', countries: { PL: false, DE: false, CY: false, UA: true, BY: true, RS: false, GE: true, RU: true, AZ: true, KZ: true, AM: true } },
            { date: '06 Apr', day: 'Mon', cw: 'CW15', holidayName: 'Easter Monday (Catholic)', countries: { PL: true, DE: true, CY: false, UA: false, BY: false, RS: false, GE: false, RU: false, AZ: false, KZ: false, AM: false } },
            { date: '13 Apr', day: 'Mon', cw: 'CW16', holidayName: 'Easter Monday (Orthodox)', countries: { PL: false, DE: false, CY: true, UA: true, BY: false, RS: true, GE: true, RU: false, AZ: false, KZ: false, AM: false } },
            { date: '01 May', day: 'Fri', cw: 'CW18', holidayName: 'Labour Day', countries: { PL: true, DE: true, CY: true, UA: true, BY: true, RS: true, GE: false, RU: true, AZ: true, KZ: true, AM: true } },
            { date: '25 Dec', day: 'Fri', cw: 'CW52', holidayName: 'Christmas Day (Catholic)', countries: { PL: true, DE: true, CY: true, UA: true, BY: true, RS: false, GE: false, RU: false, AZ: false, KZ: false, AM: false } },
            { date: '31 Dec', day: 'Thu', cw: 'CW53', holidayName: 'New Year\'s Eve', countries: { PL: false, DE: false, CY: false, UA: false, BY: false, RS: false, GE: true, RU: true, AZ: false, KZ: false, AM: true } },
        ];
        const countryCodes = ['PL', 'DE', 'CY', 'UA', 'BY', 'RS', 'GE', 'RU', 'AZ', 'KZ', 'AM'];

        document.addEventListener('DOMContentLoaded', () => {
            const D = document;
            const htmlElement = D.documentElement;
            const themeSwitcher = D.getElementById('theme-switcher');
            const scrollToTopBtn = D.getElementById('scrollToTopBtn');
            const copyrightYearSpan = D.getElementById('copyright-year');
            const tableHeader = D.getElementById('tableHeader');
            const tableBody = D.getElementById('tableBody');
            const tableFooter = D.getElementById('tableFooter');

            const render = () => {
                // --- RENDER HEADER ---
                let headerHtml = '<tr>';
                ['Date', 'Day', 'CW', 'Holiday', 'Count', ...countryCodes].forEach(col => {
                    headerHtml += `<th scope="col" data-column-id="${col.toLowerCase()}">${col}</th>`;
                });
                headerHtml += '</tr>';
                tableHeader.innerHTML = headerHtml;

                // --- RENDER BODY & CALCULATE TOTALS ---
                let bodyHtml = '';
                const footerTotals = { total: 0, countries: countryCodes.reduce((acc, code) => ({ ...acc, [code]: 0 }), {}) };
                holidayData.forEach(item => {
                    const count = Object.values(item.countries).filter(Boolean).length;
                    countryCodes.forEach(code => { if (item.countries[code]) footerTotals.countries[code]++; });

                    const countryCells = countryCodes.map(code => 
                        `<td data-label="${code}" data-column-id="${code.toLowerCase()}"><span class="status-tag ${item.countries[code] ? 'status-tag--yes">✔' : 'status-tag--no">'}</span></td>`
                    ).join('');

                    bodyHtml += `<tr>
                        <td data-label="Date" data-column-id="date">${item.date}</td><td data-label="Day" data-column-id="day">${item.day}</td><td data-label="CW" data-column-id="cw">${item.cw}</td>
                        <td data-label="Holiday" data-column-id="holiday"><span class="holiday-name">${item.holidayName}</span></td>
                        <td data-label="Count" data-column-id="count">${count}</td>
                        ${countryCells}
                    </tr>`;
                });
                tableBody.innerHTML = bodyHtml;
                
                // --- RENDER FOOTER ---
                const totalHolidays = Object.values(footerTotals.countries).reduce((sum, val) => sum + val, 0);
                const countryFooterCells = countryCodes.map(code => {
                    const value = footerTotals.countries[code];
                    let colorStyle = '';
                    if (value < 5) colorStyle = 'style="color: var(--color-danger);"';
                    else if (value > 5) colorStyle = 'style="color: var(--color-success);"';
                    else colorStyle = 'style="color: var(--color-text-primary);"';
                    return `<td data-label="${code}" data-column-id="${code.toLowerCase()}" ${colorStyle}>${value}</td>`;
                }).join('');

                const footerHtml = `<tr>
                    <th scope="row" colspan="5" data-label="Summary" data-column-id="summary">Company's Holidays Total: 9 Days</th>
                    ${countryFooterCells}
                </tr>`;
                tableFooter.innerHTML = footerHtml;
            };
            
            // --- UI LOGIC ---
            const savedTheme = localStorage.getItem('theme') || 'dark';
            htmlElement.setAttribute('data-theme', savedTheme);
            themeSwitcher.addEventListener('click', () => { const newTheme = htmlElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'; htmlElement.setAttribute('data-theme', newTheme); localStorage.setItem('theme', newTheme); });
            window.addEventListener('scroll', () => scrollToTopBtn.classList.toggle('is-visible', window.scrollY > 200));
            scrollToTopBtn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
            copyrightYearSpan.textContent = new Date().getFullYear();
            
            render();
        });
    })();
    </script>
</body>
</html>
